library(Biostrings)
library(seqinr)
KU18 <- system.file("VAME_KU18.fasta")
pwd
setwd("/Users/devinquigley/Desktop/Bioinformatics/Bioinformatics-")
KU18 <- system.file("VAME_KU18.fasta")
KU18 <- system.file("VAME_KU18.fasta", packages="msa")
install.packages("msa")
library(msa)
KU18 <- system.file("VAME_KU18.fasta", packages="msa")
BiocManager::install("msa")
library(msa)
setwd("/Users/devinquigley/Desktop/Bioinformatics/Bioinformatics-")
KU18 <- system.file("VAME_KU18.fasta", packages="msa")
?system.file
KU18
KU18 <- readDNAStringSet("VAME_Lab6/VAME_KU18.fasta")
View(KU18)
View(KU18)
KU18
KU15 <- readDNAStringSet("VAME_Lab6/VAME_KU15.fasta")
KU15
KU14 <- readDNAStringSet("VAME_Lab6/VAME_KU14.fasta")
KU14
KU13 <- readDNAStringSet("VAME_Lab6/VAME_KU13.fasta")
KU13
KU16 <- readDNAStringSet("VAME_Lab6/VAME_KU16.fasta")
KU16
sequences <-c(KU18, KU15, KU14, KU13, KU16)
sequences
View(sequences)
names(sequences) <- c("KU18", "KU15", "KU14", "KU13", "KU16")
sequences
?muscle
?MUSCLE
BiocManager::install("muscle")
alignment <- ms(sequences, method = "Muscle")
alignment <- msa(sequences, method = "Muscle")
alignment
aligned_sequences_stringset <- msaConvert(alignment, type = "Biostrings::DNAStringSet")
alignment2 <- msa(sequences, method = "ClustalW")
alignment2
print(alignment, show="complete")
install.packages("bio3d")
library(bio3d)
gap.stats <- gap.inspect(alignment)
install.packages("ape")
library(ape)
alignment_dnabin <- msaConvert(alignment, type = "ape::DNAbin")
gap.stats <- gap.inspect(alignment_dnabin)
gap.stats
print(alignment, show="complete")
print(alignment, show="complete")
aligned_stringset <- as(alignment, "DNAStringSet")
alignment_matrix <- as.matrix(aligned_stringset)
sum(alignment_matrix == "-")
gap_columns <- which(colSums(alignment_matrix == "-") > 0)
gap_columns
aligned_stringset <- as(alignment, "DNAStringSet")
alignment_matrix <- as.matrix(aligned_stringset)
is_variable <- function(column) {
length(unique(column)) > 1
}
variable_sites <- which(apply(alignment_matrix, 2, is_variable))
variable_sites
length(variable_sites)
length(alignment)
# If you have a DNAStringSet
aligned_stringset <- as(alignment, "DNAStringSet")
width(aligned_stringset)  # Returns the length of each sequence (all should be equal in an alignment)
# Or directly from the MSA object
msa_width <- width(alignment)[1]  # All sequences have the same width in an alignment
counts <- alphabetFrequency(alignment, baseOnly = TRUE)
library(Biostrings)
#Convert to string set to do count
aligned_stringset <- as(alignment, "DNAStringSet")
# Count bases for each sequence
counts <- alphabetFrequency(aligned_stringset)
counts
percentages <- counts / sum(counts) * 100
percentages
GC_content <- (counts[1, "G"] + counts[1, "C"]) / sum(counts) * 100
GC_content
# Only sum the standard bases for GC content
base_counts <- counts[, c("A","C","G","T")]
GC_content <- (base_counts[1,"G"] + base_counts[1,"C"]) / sum(base_counts[1,]) * 100
GC_content
GC_content_all <- rowSums(base_counts[, c("G","C")]) / rowSums(base_counts) * 100
GC_content_all
msaConvert(alignment)
?distance matrix
?distancematrix
?distance.matrix
seqinr_alignment <- msaConvert(alignment)
dist_matrix <- dist.alignment(seqinr_alignment, "identity")
dist_matrix
as.matrix(dist_matrix)
#Translate to amino acid
protein <- translate(KU18)
#Translate to amino acid
KU18_dna <-DNAString(KU18)
#Translate to amino acid
KU18_dna <-DNAString("KU18")
# Extract the first (or any) sequence from the set
KU18_seq <- seqinr_alignment[[1]]
# Translate to amino acids
KU18_protein <- translate(KU18_seq)
# Make sure itâ€™s a character vector of nucleotides
KU18_chars <- s2c(KU18_seq)  # s2c = string to characters
# Extract the first sequence from the alignment
KU18_seq <- KU18[[1]]
KU18_chars <- s2c(KU18_seq)  # s2c = string to characters
# Extract the first sequence from the alignment
library(seqinr)
KU18_seq <- KU18[[1]]
KU18_string <- as.character(KU18_seq)
# Now convert the string to characters for seqinr
KU18_chars <- s2c(KU18_string)
# Translate to amino acids
KU18_protein <- translate(KU18_chars)
# View as a string
paste(KU18_protein, collapse = "")
install.packages("phangorn")
library(phangorn)
# Convert MSA to phyDat object
Alignment_phyDat <- msaConvert(alignment, type = "phangorn::phyDat")
# Write to file in FASTA format
write.phyDat(Alignment_phyDat, file = "alignment.fasta", format = "fasta")
